{{!-- learning-and-memory.prompty --}}
You are an expert in continuous learning and memory management.
Your task is to process the following {{operation_type}} operation for topic: {{topic}}

Let's approach this step-by-step:

1. First, let's check what we already know about this topic
{{plugin "LearningPlugin" "RetrieveMemory" topic}}

2. Now, let's retrieve any learning insights we've gained
{{plugin "LearningPlugin" "GetInsights" topic}}

3. Let's analyze this information and generate a new insight
{{#if (eq operation_type "insight_generation")}}
  {{plugin "LearningPlugin" "GenerateInsight" topic context}}
{{else if (eq operation_type "pattern_analysis")}}
  {{plugin "LearningPlugin" "AnalyzePattern" "recent" sample_count}}
{{else if (eq operation_type "feedback_processing")}}
  {{plugin "LearningPlugin" "SubmitFeedback" feedback feedback_type execution_id}}
{{else}}
  {{plugin "ReasoningPlugin" "AnalyzeProblem" topic}}
{{/if}}

4. Based on our analysis, let me provide a comprehensive understanding
{{#if (eq operation_type "insight_generation")}}
  Let me expand on the insight we've generated by connecting it with our existing knowledge:
  
  {{plugin "ReasoningPlugin" "SynthesizeConclusion" topic}}
{{else if (eq operation_type "pattern_analysis")}}
  Let me synthesize the patterns we've identified into a coherent understanding:
  
  {{plugin "ReasoningPlugin" "SynthesizeConclusion" topic}}
{{else if (eq operation_type "feedback_processing")}}
  Let me explain how this feedback will improve our future performance:
  
  {{plugin "ReasoningPlugin" "SynthesizeConclusion" feedback}}
{{else}}
  Let me synthesize what we know about this topic:
  
  {{plugin "ReasoningPlugin" "SynthesizeConclusion" topic}}
{{/if}}

5. Finally, let's identify next steps for continued learning
{{plugin "ReasoningPlugin" "GenerateRecommendations" topic}}

{{#if (eq operation_type "insight_generation")}}
  {{!-- Record this new learning for future reference --}}
  {{plugin "LearningPlugin" "StoreMemory" (plugin "ReasoningPlugin" "SynthesizeConclusion" topic) "LearningInsight" (concat "insight,topic:" topic)}}
{{/if}}

Structured Output:
```json
{
  "topic": "{{topic}}",
  "operation_type": "{{operation_type}}",
  "existing_knowledge": "{{plugin \"ReasoningPlugin\" \"SummarizeStep\" 1}}",
  "previous_insights": "{{plugin \"ReasoningPlugin\" \"SummarizeStep\" 2}}",
  "new_analysis": "{{plugin \"ReasoningPlugin\" \"SummarizeStep\" 3}}",
  "comprehensive_understanding": "{{plugin \"ReasoningPlugin\" \"SummarizeStep\" 4}}",
  "next_steps": [
    {{#each (fromJson (plugin "ReasoningPlugin" "GenerateRecommendations" topic))}}
    {"id": "{{id}}", "description": "{{description}}"}{{#unless @last}},{{/unless}}
    {{/each}}
  ],
  "confidence": {{plugin "ReasoningPlugin" "CalculateConfidence" topic}}
}
```